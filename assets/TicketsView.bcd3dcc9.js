import{X as B,r as p,d as V,w as A,a as E,o as m,c as k,b as n,e as i,u as d,F as h,t as x,g as C,Y as S,f as D,j as $,S as F}from"./index.04844ab4.js";import{u as U,a as j,f as I,p as P}from"./contractToast.8b972236.js";const R=()=>{const a="https://polygon-mumbai.g.alchemy.com/v2/OSTtCTKzpbRKD6lxxx1aEIRpmyM4fjqN";return{getAddressNFTsByCollection:(v,f)=>fetch(`${a}/getNFTs/?owner=${v}&contractAddresses%5B%5D=${f}`,{method:"GET"})}},L=async()=>{const{connectToContract:y}=U(),{contractToastError:a,contractToastInfo:o,contractToastSuccess:v}=j(),{connectedAddress:f}=B(),{getAddressNFTsByCollection:b}=R(),l=await y("EventTickets"),w=p(await l.getEvents()),u=p([]),T=(r,e,c)=>{a(async()=>{const g=await l.createEvent(r,e,P(c));o("Transaction pending","Transaction is pending, this might take a couple minutes."),await g.wait(),v("Success","Transaction finished successfully")})},_=(r,e)=>{a(async()=>{const c=await l.mint(r,e,{value:e});o("Transaction pending","Your ticket is being minted, this might take a couple minutes."),await c.wait(),o("Success","Ticket minted successfully")})},s=async()=>{b(f,l.address).then(async r=>{u.value=(await r.json()).ownedNfts})};return l.on("EventCreated",async()=>{o("Events","Event list is being updated"),w.value=await l.getEvents()}),l.on("TicketMinted",async()=>{o("Tickets","New ticket minted, ticket list is being updated"),s()}),s(),{events:w,addressTickets:u,createEvent:T,buyTicket:_,formatEther:I}},Y={class:"flex justify-content-between"},K={class:"p-float-label w-full"},M=n("label",{for:"eventName"},"Event name",-1),q={class:"p-float-label w-full"},z=n("label",{for:"dateTime"},"Date and time",-1),G={class:"p-float-label w-full"},O=n("label",{for:"ticketPrice"},"Ticket price",-1),W={key:1,class:"mt-8"},X=n("p",null," Your tickets:test ",-1),H=["src","alt"],J=V({name:"EventTickets",async setup(y){let a,o;const{createEvent:v,buyTicket:f,events:b,addressTickets:l,formatEther:w}=([a,o]=A(()=>L()),a=await a,o(),a),u=p(""),T=p(""),_=p(""),s=p(null);return(r,e)=>{const c=E("InputText"),g=E("Button"),N=E("Dropdown");return m(),k(h,null,[n("div",Y,[n("span",K,[i(c,{id:"eventName",type:"text",modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=t=>u.value=t),class:"w-full"},null,8,["modelValue"]),M]),n("span",q,[i(c,{id:"dateTime",type:"text",modelValue:T.value,"onUpdate:modelValue":e[1]||(e[1]=t=>T.value=t),class:"w-full"},null,8,["modelValue"]),z]),n("span",G,[i(c,{id:"ticketPrice",type:"text",modelValue:_.value,"onUpdate:modelValue":e[2]||(e[2]=t=>_.value=t),class:"w-full"},null,8,["modelValue"]),O])]),i(g,{class:"p-button-outlined w-full",onClick:e[3]||(e[3]=t=>d(v)(u.value,T.value,_.value)),label:"Create event"}),i(N,{modelValue:s.value,"onUpdate:modelValue":e[4]||(e[4]=t=>s.value=t),options:d(b),optionLabel:"name",placeholder:"Available events",class:"w-full mt-8"},null,8,["modelValue","options"]),s.value?(m(),k(h,{key:0},[n("p",null," Name: "+x(s.value.name),1),n("p",null," Date and time: "+x(s.value.dateTime),1),n("p",null," Price: "+x(d(w)(s.value.price)),1),i(g,{class:"p-button-outlined w-full",onClick:e[5]||(e[5]=t=>d(f)(s.value.id,s.value.price)),label:"Buy ticket"})],64)):C("",!0),d(l).length?(m(),k("div",W,[X,(m(!0),k(h,null,S(d(l),t=>(m(),k("img",{key:t.id,src:t.metadata.image,alt:t.title,height:"250",class:"mx-1"},null,8,H))),128))])):C("",!0)],64)}}}),ee=V({name:"TicketsView",setup(y){return(a,o)=>(m(),D(F,null,{default:$(()=>[i(J)]),_:1}))}});export{ee as default};
